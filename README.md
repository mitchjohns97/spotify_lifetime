Go to https://www.spotify.com/us/account/privacy/ and download Extended Streaming History. This can take up to 30 days to prepare.

To use an existing streaming history, go here https://drive.google.com/drive/folders/1t1Aotyxb5GpyMs9yItHTAGcvHPQ2as3H?usp=sharing.

Feel free to message me for api id and secret.

If you run this and add to library I'd welcome a pr to update library.
